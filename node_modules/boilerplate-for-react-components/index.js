#!/usr/bin/env node
'use strict';

var fs = require('fs');
var args = process.argv.splice(2,process.argv.length);
var argsList = {};
var root = null;
var cName = null; //component name
var path = null; //complete path to component

if(args.length == 2){
	path = argsList['path'] = args[0];
	cName = argsList['cName'] = args[1];
	root = path + '/' +cName;
}else if(args.length == 1){
	console.warn("Warn: Please provide a name via commond line. Ex: `node index.js 'TEST'`");
}

if(argsList['cName']){
	if(!fs.existsSync(root)) {

		//component specific.
		fs.mkdirSync(root);
		fs.writeFile(root+'/'+cName+'.jsx', "import React , { Component , PropTypes} from 'react'; \nimport styles from './"+cName+".css';\n\nexport default class "+cName+" extends Component{ \n\n 	constructor(){ \n 		super(); \n 	} \n 	render() { \n 	return(\n	<div>\n 			"+cName+" Component \n 		</div> \n ) \n	}\n\n}" , function (err) {
		    if (err) return console.log(err);
		});
		fs.writeFile(root+'/'+cName+'.css', '', function (err) {
		    if (err) return console.log(err);
		});
		fs.writeFile(root+'/'+cName+'.text.jsx', "import React from 'react'; \nimport { shallow } from 'enzyme'; \nimport { expect } from 'chai'; \nimport "+cName+" from ./"+cName+".jsx;", function (err) {
		    if (err) return console.log(err);
		});

		//stories.
		if(!fs.existsSync(root+'/__stories')) fs.mkdirSync(root+'/__stories');
		fs.writeFile(root+'/__stories/index.js', "import React from 'react'; \nimport "+cName+" from '../"+cName+"'; \n \nconst stories = [ \n 	{ \n 		name: '"+cName+"', \n 		story: () => ( \n 			<div> \n 				<"+cName+" /> \n 			</div> \n 		) \n 	} \n ]; \n export default stories;"	,	function (err) {
			if (err) return console.log(err);
		});

		console.log('Component succesfully created');

	}else{
		console.error('Err: Specified Component already exist !!!');
	}
}
